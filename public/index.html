<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Collaborative Document Editor</title>

    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>

</head>

<body>

<div id="editor">
    <p>Hello World!</p>
    <p>Some initial <strong>bold</strong> text</p>
    <p><br /></p>
</div>

<script>

    var ws = new WebSocket("ws://127.0.0.1:8080/ws/");

    ws.onopen = function (event) {
        console.log("Connection opened");
    };

    ws.onmessage = function (event) {
        console.log("Message from server ", event.data);
        document.getElementById('editor').innerHTML = event.data;
    };

    ws.onclose = function (event) {
        console.log("Connection closed");
    };

    var toolbarOptions = [
        ['bold', 'italic', 'underline']  // Aggiungi solo i pulsanti che desideri
    ];

    var quill = new Quill('#editor', {
        modules: {
            toolbar: toolbarOptions  // Usa la configurazione personalizzata della toolbar
        },
        theme: 'snow'  // Usa il tema "snow" che include una UI predefinita
    });


    quill.on('text-change', (delta, oldDelta, source) => {

        if (source == 'user') {
            const delta = quill.getContents();
            console.log(delta);
            ws.send(JSON.stringify(delta));
        }
    });

    ws.onmessage = function (event) {
        console.log("Message from server ", event.data);
        let value = JSON.parse(event.data);
        quill.setContents(value);
    };

</script>

</body>

</html>